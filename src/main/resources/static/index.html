<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Foundation | Welcome</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/nfclient.js"></script>
  </head>

  <body>
    <div id="score1"></div>
    <script>
      // Initialize the Noteflight client API.
      NFClient.init(function(info) {
        //alert("Noteflight API is ready, version " + info.version);
      });

      var options = {
        host: 'hacking.sites.noteflight.com',
        width: 900,
        height: 600,
        viewParams: {
          scale: 1.5,
          app: 'html5'
        }
      };

      var scoreView = new NFClient.ScoreView('score1', '3b88798c7533d46aa60c3c8077e44742c7c4027a', options);

      function loadScore() {
        scoreView.loadMusicXML('<score-partwise version="3.0"><part-list><score-part id="P1"><part-name>Cantus firmus</part-name></score-part><score-part id="P2"><part-name>Melody 1</part-name></score-part><score-part id="P3"><part-name>Melody 2</part-name></score-part><score-part id="P4"><part-name>Melody 3</part-name></score-part></part-list><part id="P1"><measure number="1"><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="2"><note><pitch><step>F</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="3"><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="4"><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="5"><note><pitch><step>G</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="6"><note><pitch><step>F</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="7"><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="8"><note><pitch><step>G</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="9"><note><pitch><step>F</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="10"><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="11"><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure></part><part id="P2"><measure number="1"><note><pitch><step>D</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="2"><note><pitch><step>D</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="3"><note><pitch><step>E</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="4"><note><pitch><step>G</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="5"><note><pitch><step>G</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="6"><note><pitch><step>D</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="7"><note><pitch><step>C</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="8"><note><pitch><step>E</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="9"><note><pitch><step>A</step><alter>0</alter><octave>2</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="10"><note><pitch><step>C</step><alter>1</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="11"><note><pitch><step>D</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure></part><part id="P3"><measure number="1"><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="2"><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="3"><note><pitch><step>G</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="4"><note><pitch><step>B</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="5"><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="6"><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="7"><note><pitch><step>C</step><alter>0</alter><octave>5</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="8"><note><pitch><step>B</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="9"><note><pitch><step>C</step><alter>0</alter><octave>5</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="10"><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="11"><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure></part><part id="P4"><measure number="1"><note><pitch><step>D</step><alter>0</alter><octave>5</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>C</step><alter>0</alter><octave>5</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="2"><note><pitch><step>B</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="3"><note><pitch><step>C</step><alter>0</alter><octave>5</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>B</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="4"><note><pitch><step>G</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="5"><note><pitch><step>B</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>C</step><alter>0</alter><octave>5</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="6"><note><pitch><step>D</step><alter>0</alter><octave>5</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>A</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="7"><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>F</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="8"><note><pitch><step>G</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="9"><note><pitch><step>C</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>D</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="10"><note><pitch><step>E</step><alter>0</alter><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>A</step><alter>0</alter><octave>3</octave></pitch><duration>2</duration><type>half</type></note></measure><measure number="11"><note><pitch><step>A</step><alter>0</alter><octave>3</octave></pitch><duration>4</duration><type>whole</type></note></measure></part></score-partwise>');
      }

      function callCounterpointService() {
        var cantusFirmusJson = JSON.stringify({
          //"mainMelody" : [62, 65, 64, 62, 67, 65, 69, 67, 65, 64, 62],
          "mainMelody" : [60, 62, 64, 65, 67, 69, 71, 72, 67, 64, 62, 60],
          //"partsInitialNotes" : [50, 69, 74],
          "partsInitialNotes" : [67, 72, 84],
          //"counterpointSpecies" : 2,
          "counterpointSpecies" : 3,
          //"scaleMode" : 2
          "scaleMode" : 6
        });

        $.ajax({
          url:'http://localhost:8080/counterpoint',
          type:'post',
          data : cantusFirmusJson,
          contentType: "application/json",
          dataType: 'json',
          success: function(data) {
            scoreView.loadMusicXML(data);
            //loadScore(data);
            //window.alert( 'success..')
          },
          error: function (xhr) {
            scoreView.loadMusicXML(xhr.responseText);
            //loadScore(data);
            //window.alert( 'error! '+ xhr.responseText);
            //alert("error: " + xhr.responseText);
          }
        });
      }

      // Uncomment the following after ascertaining how to get the serialized XML from the arg passed into the done method
      /*
      function callCounterpointService() {
        var cantusFirmusJson = {
          "mainMelody": [62, 65, 64, 62, 67, 65, 69, 67, 65, 64, 62],
          "partsInitialNotes": [50, 69, 74],
          "counterpointSpecies": 2,
          "scaleMode": 2
        };
        cantusFirmusJson = JSON.stringify(cantusFirmusJson);
        $.ajax({
          method: 'POST',
          contentType: 'application/json',
          url: 'http://localhost:8080/counterpoint',
          data: cantusFirmusJson,
        }).done(function (msg) {
          alert( msg + " msg.responseText: " + msg.responseText);
          //scoreView.loadMusicXML(msg);
        });
      }
      */

    </script>

    <div class="row">
      <div class="large-8 columns">
        <h1>Composing Music in the Cloud</h1>

        <div class="small-4 columns">
          <button class="small button" onclick="loadScore()">loadScore</button>
        </div>
        <div class="small-6 columns">
          <button class="small button" onclick="callCounterpointService()">callCounterpointService</button>
        </div>

      </div>
    </div>
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>
  </body>
</html>
